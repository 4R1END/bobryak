const btnDown=document.querySelectorAll(".quantity-block__btn-down"),btnUp=document.querySelectorAll(".quantity-block__btn-up"),inputQuantity=document.querySelectorAll(".quantity-block__input"),price=document.querySelectorAll(".card__price"),btnAddToCart=document.querySelectorAll(".card__btn-basket"),weightBlock=document.querySelectorAll(".weight-checkbox");inputQuantity.forEach(t=>{t.addEventListener("keydown",t=>{46==t.keyCode||8==t.keyCode||9==t.keyCode||27==t.keyCode||65==t.keyCode&&!0===t.ctrlKey||t.keyCode>=35&&t.keyCode<=39||(t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&t.preventDefault()})}),btnDown.forEach(t=>{t.addEventListener("click",(function(){parseInt(t.nextElementSibling.value)>1&&(t.nextElementSibling.value=parseInt(t.nextElementSibling.value)-1)}))}),btnUp.forEach(t=>{t.onclick=function(){t.previousElementSibling.value=parseInt(t.previousElementSibling.value)+1}}),price.forEach(t=>{t.closest(".card").dataset.price=parseInt(t.textContent)});const generateCartProducts=(t,e,r,a)=>`\n\t\t<tr class="product">\n\t\t\t<td class="product__name">\n\t\t\t\t<img src="${t}" alt="Балхам">\n\t\t\t\t<div class="product__options">\n\t\t\t\t\t<h3 class="product__title">\n\t\t\t\t\t\t${e}\n\t\t\t\t\t</h3>\n\t\t\t\t\t<div class="product__weight weight-checkbox">\n\t\t\t\t\t\t<label class="weight-checkbox__weight-light">\n\t\t\t\t\t\t\t<input type="radio" name="weight_balham" value="150">\n\t\t\t\t\t\t\t<span>150 гр</span>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<label class="weight-checkbox__weight-middle">\n\t\t\t\t\t\t\t<input type="radio" name="weight_balham" value="200">\n\t\t\t\t\t\t\t<span>200 гр</span>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<label class="weight-checkbox__weight-big">\n\t\t\t\t\t\t\t<input type="radio" name="weight_balham" value="250">\n\t\t\t\t\t\t\t<span>250 гр</span>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t\t<td class="product__price" data-150="1350" data-200="1570" data-250="1800">\n\t\t\t\t${r} ₽\n\t\t\t</td>\n\t\t\t<td class="product__quantity">\n\t\t\t\t<div class="product__quantity-block quantity-block">\n\t\t\t\t\t<button class="quantity-block__btn-down">\n\t\t\t\t\t\t-\n\t\t\t\t\t</button>\n\t\t\t\t\t<span>${a}</span>\n\t\t\t\t\t<button class="quantity-block__btn-up">\n\t\t\t\t\t\t+\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t\t<td class="product__sum">\n\t\t\t\t1350 ₽\n\t\t\t</td>\n\t\t\t<td class="product__delete">\n\t\t\t\t<button class="btn-remove-product-js">\n\t\t\t\t\t<img src="img/icons/close.svg" alt="удалить">\n\t\t\t\t</button>\n\t\t\t</td>\n\t\t</tr>\t\n\t`,updateStorage=t=>{let e=t.innerHTML;localStorage.setItem("products",e)};let productsWrapper=document.createElement("table");productsWrapper.className="products-wrapper";let productsWrapperBody=document.createElement("tbody");productsWrapperBody.className="tbody",productsWrapper.insertAdjacentElement("afterbegin",productsWrapperBody),btnAddToCart.forEach(t=>{t.addEventListener("click",t=>{let e=t.currentTarget.closest(".card"),r=e.querySelector(".card__image-main").getAttribute("src"),a=e.querySelector(".card__title").textContent,c=parseInt(e.querySelector(".card__price").textContent),n=e.querySelector(".card__quantity-block span").textContent;productsWrapper.querySelector("tbody").insertAdjacentHTML("beforeEnd",generateCartProducts(r,a,c,n)),updateStorage(productsWrapper.querySelector("tbody"))})});const rangeSlider=document.getElementById("range-slider");rangeSlider&&noUiSlider.create(rangeSlider,{start:[100,1e4],connect:!0,step:1,range:{min:[100],max:[1e4]}});const inputMin=document.getElementById("input-min"),inputMax=document.getElementById("input-max"),inputsArray=[inputMin,inputMax];rangeSlider.noUiSlider.on("update",(function(t,e){inputsArray[e].value=Math.round(t[e])}));const setRangeValue=(t,e)=>{let r=[null,null];r[t]=e,rangeSlider.noUiSlider.set(r)};inputsArray.forEach((t,e)=>{t.addEventListener("change",t=>{setRangeValue(e,t.currentTarget.value)})});const defaultSelect=()=>{const t=document.querySelector(".js-choice");new Choices(t,{searchEnabled:!1})};defaultSelect();const popupContainer=document.querySelector(".popup-container"),body=document.body,diableScroll=()=>{let t=window.scrollY;body.classList.add("scroll-disable"),body.dataset.position=t,body.style.top=-t+"px"},enableScroll=()=>{let t=parseInt(body.dataset.position,10);body.style.top="auto",body.classList.remove("scroll-disable"),window.scroll({top:t,left:0}),body.removeAttribute("data-position")},popupOpen=()=>{popupContainer.classList.add("active")};popupContainer.addEventListener("click",t=>{t.target.classList.contains("popup__close")&&popupContainer.classList.remove("active"),t.target.classList.contains("popup-container")&&popupContainer.classList.remove("active")});const cards=document.querySelectorAll(".card"),catalog=document.querySelector(".catalog__cards"),cardsOfCatalog=catalog.querySelectorAll(".card"),RangeBtnsBlock=document.querySelector(".catalog__range-view"),filtersTitle=document.querySelectorAll(".filters__title"),paginationLine=document.querySelector(".pagination__line"),paginationLineComplete=document.querySelector(".pagination__line"),generalCountCards=cardsOfCatalog.length,currentCountCardsBlock=document.querySelector(".pagination__current"),generalCountCardsBlock=document.querySelector(".pagination__general"),btnMoreFilters=document.querySelectorAll(".btn-more-filters-js"),btnMoreCards=document.querySelector(".btn--more-js"),filtersForm=document.querySelector(".sidebar__form"),setDataRoundPer3=(t,e)=>{e<=2&&t.setAttribute("data-round","0"),e>=3&&e<=5&&t.setAttribute("data-round","1"),e>=6&&e<=8&&t.setAttribute("data-round","2"),e>=9&&e<=11&&t.setAttribute("data-round","3"),e>=12&&e<=14&&t.setAttribute("data-round","4")};cardsOfCatalog.forEach((t,e)=>{setDataRoundPer3(t,e)}),filtersTitle.forEach(t=>{t.addEventListener("click",(function(){t.classList.toggle("active"),t.nextElementSibling.classList.toggle("active"),null!=t.closest(".filters__item").querySelector(".filters__more-btn")&&t.closest(".filters__item").querySelector(".filters__more-btn").classList.toggle("active"),Array.from(t.nextElementSibling.children).forEach(t=>{t.classList.contains("visible")||t.classList.add("hide")})}))}),btnMoreFilters.forEach(t=>{t.addEventListener("click",()=>{t.classList.contains("less")?(t.closest(".filters__item").querySelectorAll(".filters__label").forEach(t=>{t.classList.contains("visible")||t.classList.add("hide")}),t.innerText="+",t.classList.remove("less")):t.closest(".filters__item").querySelectorAll(".filters__label").forEach(e=>{e.classList.remove("hide"),e.classList.contains("hide")||(t.innerText="-",t.classList.add("less"))})})}),RangeBtnsBlock.addEventListener("click",()=>{Array.from(RangeBtnsBlock.children).forEach(t=>{t.classList.toggle("active")}),catalog.classList.toggle("list")}),cards.forEach(t=>{const e=t.querySelector(".card__image-main").getAttribute("src"),r=t.querySelector(".card__title").innerText.replace(/[\r\n]+/gm,""),a=t.querySelector(".card__price").innerText.replace(/[\r\n]+/gm,""),c=t.querySelector(".card__descr").innerText.replace(/[\r\n]+/gm,""),n=t.dataset.name,l=t.querySelectorAll(".quantity-block"),o=t=>{(t.target.classList.contains("card__image-main")||t.target.classList.contains("card__title")||t.target.classList.contains("card__btn--more-descr"))&&(popupContainer.classList.add("active"),popupContainer.querySelector(".popup__img").setAttribute("src",""+e),popupContainer.querySelector(".popup__title").innerText=r,popupContainer.querySelector(".popup__price").innerText=a,popupContainer.querySelector(".popup__quantity-block").children[1].value=l[0].children[1].value,popupContainer.querySelector(".popup__descr").innerText=c,popupContainer.querySelector(".popup__more-link").setAttribute("href",`card_${n}.html`))};t.addEventListener("click",t=>{o(t)}),t.querySelector(".card__btn--more-descr").addEventListener("click",t=>{o(t)})});const fillPaginationLine=(t,e)=>100/t*e;document.addEventListener("DOMContentLoaded",()=>{generalCountCardsBlock.innerText=generalCountCards;let t=document.querySelectorAll(".card.active").length;currentCountCardsBlock.innerText=t,paginationLineComplete.style.width=fillPaginationLine(generalCountCards,t)+"%",btnMoreCards.addEventListener("click",()=>{t=document.querySelectorAll(".card.active").length,currentCountCardsBlock.innerText=t,paginationLineComplete.style.width=fillPaginationLine(generalCountCards,t)+"%",t===generalCountCards&&(btnMoreCards.classList.remove("btn--primary"),btnMoreCards.classList.add("btn--disable"))})}),filtersForm.addEventListener("submit",t=>{t.preventDefault()});const moreProductsBtn=document.querySelector(".btn--more-js"),cardsShow=document.querySelectorAll('.card[data-round="0"]'),cardsFirstRound=document.querySelectorAll('.card[data-round="1"]'),cardsSecondRound=document.querySelectorAll('.card[data-round="2"]');cardsShow.forEach(t=>{t.classList.add("active")}),moreProductsBtn.addEventListener("click",()=>{cardsSecondRound.forEach(t=>{console.log(cardsFirstRound[0].classList.contains("active")),cardsFirstRound[0].classList.contains("active")&&!t.classList.contains("active")&&t.classList.add("active")}),cardsFirstRound.forEach(t=>{t.classList.contains("active")||t.classList.add("active")})});const btnApplyFilters=document.querySelector(".filters__btn--apply"),checkedFiltersBlock=document.querySelector(".filters__checked-filters"),clearFiltersBtn=document.querySelector(".filters__btn-clear");let checkedValues;function getCheckedCheckBoxes(){const t=document.querySelectorAll(".filters__checkbox:checked");return checkedValues=Array.from(t).map(t=>t.value),checkedValues}const clearFilters=()=>{for(;checkedFiltersBlock.firstChild;)checkedFiltersBlock.removeChild(checkedFiltersBlock.firstChild)};btnApplyFilters.addEventListener("click",()=>{const t=document.getElementById("input-min"),e=document.getElementById("input-max"),r=[parseInt(t.value),parseInt(e.value)],a=document.querySelectorAll(".filters__checkbox:checked"),c=Array.from(a).map(t=>t.nextElementSibling.textContent);clearFilters(),getCheckedCheckBoxes(),clearFiltersBtn.classList.add("active"),cardsOfCatalog.forEach(t=>{const e=t.dataset.price,a=t.dataset.f;t.classList.remove("hide"),e>=r[0]&&e<=r[1]&&t.classList.add("hide"),checkedValues.length>0&&t.classList.remove("hide"),checkedValues.some(t=>{if(e>=r[0]&&e<=r[1])return t==a})||t.classList.add("hide"),!checkedValues.length>0&&e>=r[0]&&e<=r[1]&&t.classList.remove("hide")}),checkedValues.forEach((t,e)=>{checkedFiltersBlock.insertAdjacentHTML("afterBegin",`\n\t\t\t<div class="filters__checked-filter"  data-f="${a[e].value}">\n\t\t\t\t<span>${c[e]}</span>\n\t\t\t\t<button class="filter-remove"></button>\n\t\t\t</div>\n\t\t`)})}),clearFiltersBtn.addEventListener("click",()=>{clearFilters(),clearFiltersBtn.classList.remove("active"),document.querySelectorAll('input[type="checkbox"]').forEach(t=>{t.checked=!1}),cardsOfCatalog.forEach(t=>{t.classList.remove("hide")})}),checkedFiltersBlock.addEventListener("click",t=>{const e=document.querySelectorAll(".filters__checkbox:checked");if(t.target.classList.contains("filter-remove")){t.target.closest(".filters__checked-filter").remove(),e.forEach(e=>{e.value===t.target.closest(".filters__checked-filter").dataset.f&&(e.checked=!1),checkedFiltersBlock.firstChild||clearFiltersBtn.classList.add("hide")});const r=t.target.closest("filters__checked-filter").dataset.f;document.querySelectorAll(`.card[data-f="${r}"]`).forEach(t=>{t.classList.remove("hide")})}});const sortSelect=document.getElementById("sortselect"),dataPrice="price",getSelectValue=()=>sortSelect.value,insertAfter=(t,e)=>e.parentNode.insertBefore(t,e.nextSibling),sortToUp=t=>{for(let e=0;e<catalogCards.children.length;e++)for(let r=e;r<catalogCards.children.length;r++)+catalogCards.children[e].dataset[t]>+catalogCards.children[r].dataset[t]&&(replacedNode=catalogCards.replaceChild(catalogCards.children[r],catalogCards.children[e]),insertAfter(replacedNode,catalogCards.children[e]))},sortToDown=t=>{for(let e=0;e<catalogCards.children.length;e++)for(let r=e;r<catalogCards.children.length;r++)+catalogCards.children[e].dataset[t]<+catalogCards.children[r].dataset[t]&&(replacedNode=catalogCards.replaceChild(catalogCards.children[r],catalogCards.children[e]),insertAfter(replacedNode,catalogCards.children[e]))},sort=t=>{"price-up"===t&&sortToUp("price"),"price-down"===t&&sortToDown("price"),"new"===t&&sortToDown("new"),"popular"===t&&sortToDown("popular"),"sale"===t&&sortToDown("sale")};sortSelect.addEventListener("change",()=>{var t;"price-up"===(t=sortSelect.value)&&sortToUp("price"),"price-down"===t&&sortToDown("price"),"new"===t&&sortToDown("new"),"popular"===t&&sortToDown("popular"),"sale"===t&&sortToDown("sale")}),document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector(".tabs"),e=document.querySelectorAll(".tabs__block"),r=document.querySelectorAll(".tabs__btn-js");t&&t.addEventListener("click",t=>{if(t.target.classList.contains("tabs__btn-js")){r.forEach(t=>{t.classList.remove("tabs__item--active")}),t.target.classList.add("tabs__item--active");const e=t.target.dataset.tabsPath;a(e)}});const a=t=>{e.forEach(t=>{t.classList.remove("tabs__block--active")}),document.querySelectorAll(".card[data-round]").forEach(t=>{t.classList.remove("active")}),document.querySelector(`[data-tabs-target="${t}"]`).classList.add("tabs__block--active")}});